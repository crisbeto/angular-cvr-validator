/*! angular-cvr-validator 2015-06-21 */
"use strict";angular.module("angular-cvr-validator",[]).constant("validateCvrConfig",{checkRegistry:!0,cvrRegex:/^\d{8}$/,cleanupRegex:/-/g,controlNumbers:[2,7,6,5,4,3,2,1]}).directive("validateCvr",["$http","validateCvrConfig",function(a,b){var c=function(a){if(!a)return!1;var c=(a+"").replace(b.cleanupRegex,"");return b.cvrRegex.test(c)&&d(c)?c:!1},d=function(a){var c=(a+"").split(""),d=b.controlNumbers,e=0;return angular.forEach(c,function(a,b){var c=d[b];e+=a*c}),e%11===0};return{require:"ngModel",scope:{checkRegistry:"="},link:function(d,e,f,g){var h=function(e){var f=c(e),h=angular.isDefined(d.checkRegistry)?d.checkRegistry:b.checkRegistry;return g.$setValidity("cvr",!!f),f&&h?a.jsonp("//cvrapi.dk/api?vat="+f+"&country=dk&callback=JSON_CALLBACK").then(function(a){var b=a.data,c=b.hasOwnProperty("error");g.$warning=c,g.$cvrData=c?null:b},function(){g.$warning=!0,g.$cvrData=null}):g.$warning=!1,f||void 0};g.$parsers.push(h),g.$formatters.push(h)}}}]);